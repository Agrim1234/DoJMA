package com.csatimes.dojma;import android.content.Context;import android.content.SharedPreferences;import android.graphics.Color;import android.os.Bundle;import android.support.annotation.Nullable;import android.support.v4.app.Fragment;import android.support.v7.widget.DefaultItemAnimator;import android.support.v7.widget.LinearLayoutManager;import android.support.v7.widget.RecyclerView;import android.support.v7.widget.SearchView;import android.support.v7.widget.helper.ItemTouchHelper;import android.util.Log;import android.view.LayoutInflater;import android.view.View;import android.view.ViewGroup;import android.widget.EditText;import io.realm.Case;import io.realm.Realm;import io.realm.RealmConfiguration;import io.realm.RealmList;import io.realm.RealmResults;import io.realm.Sort;public class Herald extends Fragment implements SearchView.OnQueryTextListener {    public HeraldRV adapter;    private RecyclerView heraldRecyclerView;    private SharedPreferences preferences;    private SharedPreferences.Editor editor;    private Realm database;    private RealmConfiguration realmConfiguration;    private SearchView searchView;    private RealmResults<HeraldNewsItemFormat> results;    private RealmList<HeraldNewsItemFormat> resultsList;    public Herald() {        // Required empty public constructor    }    @Override    public void onCreate(@Nullable Bundle savedInstanceState) {        super.onCreate(savedInstanceState);        preferences = getContext().getSharedPreferences(DHC.USER_PREFERENCES,                Context.MODE_PRIVATE);        editor = preferences.edit();    }    @Override    public View onCreateView(LayoutInflater inflater, ViewGroup container,                             Bundle savedInstanceState) {        Log.e("TAG", "onCreateView Called");        View V = inflater.inflate(R.layout.fragment_herald, container, false);        searchView = (SearchView) V.findViewById(R.id.herald_serach_view);        EditText searchEditText = (EditText) searchView.findViewById(android.support.v7.appcompat.R.id.search_src_text);        searchEditText.setTextColor(Color.WHITE);        searchEditText.setHintTextColor(Color.parseColor("#44FFFFFF"));        searchView.setIconifiedByDefault(false);        searchView.setIconified(false);        searchView.clearFocus();        realmConfiguration = new RealmConfiguration.Builder(getContext())                .name                        (DHC.REALM_DOJMA_DATABASE).deleteRealmIfMigrationNeeded().build();        Realm.setDefaultConfiguration(realmConfiguration);        database = Realm.getDefaultInstance();        results = database.where(HeraldNewsItemFormat.class).equalTo("dismissed", false)                .findAllSorted("originalDate", Sort.DESCENDING);        resultsList = new RealmList<>();        resultsList.addAll(results);        adapter = new HeraldRV(getContext(), resultsList, database);        heraldRecyclerView = (RecyclerView) V.findViewById(R.id.herald_recycler_view);        heraldRecyclerView.setHasFixedSize(true);        heraldRecyclerView.setLayoutManager(new LinearLayoutManager(getContext()));        heraldRecyclerView.setItemAnimator(new DefaultItemAnimator());        searchView.setOnQueryTextListener(this);        heraldRecyclerView.setAdapter(adapter);        ItemTouchHelper.Callback callback =                new SimpleItemTouchHelperCallback(adapter, heraldRecyclerView);        ItemTouchHelper touchHelper = new ItemTouchHelper(callback);        touchHelper.attachToRecyclerView(heraldRecyclerView);        return V;    }    @Override    public boolean onQueryTextSubmit(String query) {        results = database.where(HeraldNewsItemFormat.class).equalTo("dismissed", false)                .beginGroup().contains                        ("title",                                query).or()                .contains("postID", query).or().contains("desc", query).endGroup()                .findAllSorted("updateDate", Sort.DESCENDING);        resultsList.clear();        resultsList.addAll(results);        adapter.notifyDataSetChanged();        return true;    }    @Override    public boolean onQueryTextChange(String newText) {        resultsList.clear();        resultsList.addAll(database.where(HeraldNewsItemFormat.class).equalTo("dismissed", false)                .beginGroup().contains("title", newText, Case                        .INSENSITIVE).or()                .contains("postID", newText, Case.INSENSITIVE).or().contains("desc", newText)                .endGroup().findAllSorted("originalDate", Sort.DESCENDING));        adapter.notifyDataSetChanged();        return true;    }}